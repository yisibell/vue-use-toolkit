import{ref as n,computed as t,onBeforeUnmount as e,onActivated as o,onDeactivated as r}from"@vue/composition-api";var i=function(n){var t=function(){return n?window.localStorage:window.sessionStorage};return{getStorage:function(n){if(!n||!t())return"";try{var e=t().getItem(n)||"";return JSON.parse(e)}catch(n){return""}},setStorage:function(n,e){if(t())return t().setItem(n,JSON.stringify(e))},removeStorage:function(n){if(t())return t().removeItem(n)},clearStorage:function(){if(t)return t().clear()}}},u=function(){return i(!1)},a=function(){return i(!0)},f="undefined"!=typeof window;function c(n){return f?requestAnimationFrame(n):-1}var l=function(i){var u,a,l,v,s=n(i.time),m=t((function(){return{total:n=s.value,days:Math.floor(n/864e5),hours:Math.floor(n%864e5/36e5),minutes:Math.floor(n%36e5/6e4),seconds:Math.floor(n%6e4/1e3),milliseconds:Math.floor(n%1e3)};var n})),d=function(){var n;l=!1,n=u,f&&cancelAnimationFrame(n)},h=function(){return Math.max(a-Date.now(),0)},g=function(n){var t,e;s.value=n,null===(t=i.onChange)||void 0===t||t.call(i,m.value),0===n&&(d(),null===(e=i.onFinish)||void 0===e||e.call(i))},w=function(){u=c((function(){l&&(g(h()),s.value>0&&w())}))},M=function(){u=c((function(){if(l){var n=h();t=n,e=s.value,(Math.floor(t/1e3)!==Math.floor(e/1e3)||0===n)&&g(n),s.value>0&&M()}var t,e}))},S=function(){f&&(i.millisecond?w():M())};return e(d),o((function(){v&&(l=!0,v=!1,S())})),r((function(){l&&(d(),v=!0)})),{start:function(){l||(a=Date.now()+s.value,l=!0,S())},pause:d,reset:function(n){void 0===n&&(n=i.time),d(),s.value=n},current:m}};export{l as useCountDown,a as useLocalStorage,u as useSessionStorage,i as useStorage};
